<div class="container">
  <h2 class="text-cWhite mt-5 mb-4">Your Meal Plan</h2>
  <%= link_to "Add to Meal Plan", "#",
    class: "btn btn-cDarkYellow mb-3 rounded-4",
    data: { bs_toggle: "collapse", bs_target: "#collapseExample" } %>
  <div class="text-cWhite collapse bg-cGray p-2 rounded-4"
    id="collapseExample"  data-controller="scheduler">
    <%= simple_form_for @schedule, url: schedule_path do |f| %>
      <%= f.input :date, as: :string, input_html: { class: "form-control", data: { controller: "datepicker" } } %>
      <label class="text-cWhite mb-2">Recipe</label>
      <div class="p-1">
        <div data-scheduler-url-value="<%= schedule_path %>">
          <%= text_field_tag :query,
          params[:query],
          class: "fd-search-input fd-pill",
          placeholder: "Type a keyword",
          data: { action: 'input->scheduler#submit', scheduler_target: "searchinput" } %>
          <div id="schedulerrecipe" class="row">
            <%= render "schedules/search", recipes: current_user.recipes %>
          </div>
        </div>
      </div>
      <%= f.input :recipe_id, as: :hidden, input_html: { data: { scheduler_target: "recipeInput" } } %>
      <%= f.submit "Create Schedule", class: "btn btn-cYellow w-100" %>
    <% end %>
  </div>
  <div class="mt-4">
    <div class="d-flex justify-content-between">
      <%= link_to schedule_path(start_date: @start_date - 1.month), class: "btn rounded-circle text-cWhite" do %>
        <i class="fa-solid fa-arrow-left"></i>
      <% end %>
      <%= link_to schedule_path(start_date: @start_date + 1.month), class: "btn rounded-circle text-cWhite" do %>
        <i class="fa-solid fa-arrow-right"></i>
      <% end %>
    </div>
    <%= month_calendar events: @schedules, attribute: :date do |date, schedules| %>
      <div class="day">
        <strong><%= date.day %></strong>
        <% schedules.each do |schedule| %>
          <div class="event">
            <%= link_to schedule.recipe.name, recipe_path(schedule.recipe) %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
